name: Update Repository Homepage

on:
  push:
    branches:
      - main
      - master

jobs:
  update-homepage:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
      - name: Get repository name
        id: repo
        run: |
          REPO_NAME=$(echo "${{ github.repository }}" | cut -d'/' -f2)
          echo "repo_name=$REPO_NAME" >> $GITHUB_OUTPUT
          echo "homepage_url=https://${REPO_NAME}.pages.dev" >> $GITHUB_OUTPUT
      
      - name: Update repository homepage via GitHub API
        run: |
          REPO_NAME="${{ steps.repo.outputs.repo_name }}"
          HOMEPAGE_URL="${{ steps.repo.outputs.homepage_url }}"
          
          curl -X PATCH \
            -H "Accept: application/vnd.github.v3+json" \
            -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
            https://api.github.com/repos/${{ github.repository }} \
            -d "{\"homepage\":\"$HOMEPAGE_URL\"}"

